一、个人认识和了解
Taf（Total Application Framework 统一应用框架）腾讯内部RPC框架，现在已经开源，用起来感觉最大的优点是 监控、报警、扩容、降级容灾、负载均衡、配置管理为一体，多机器部署时最好是使用远程日志来记录，因为多台机器的时候，每一台机器去查看debug日志比较麻烦。
二、tars接入和源码
http://tars.tencent.com/base/help/TARS_quick_start_Java.html#_Toc479268813
三、tars介绍
1. 介绍
1.1. 简介
Tars是基于名字服务使用Tars协议的高性能RPC开发框架，同时配套一体化的服务治理平台，帮助个人或者企业快速的以微服务的方式构建自己稳定可靠的分布式应用。Tars是将腾讯内部使用的微服务架构TAF（Total Application Framework）多年的实践成果总结而成的开源项目。Tars这个名字来自星际穿越电影人机器人Tars， 电影中Tars有着非常友好的交互方式，任何初次接触它的人都可以轻松的和它进行交流，同时能在外太空、外星等复杂地形上，超预期的高效率的完成托付的所有任务。 拥有着类似设计理念的Tars也是一个兼顾易用性、高性能、服务治理的框架，目的是让开发更简单，聚焦业务逻辑，让运营更高效，一切尽在掌握。
目前该框架在腾讯内部，有100多个业务、1.6多万台服务器上运行使用。
1.2. 为什么要用Taf
中转19w/s  服务端41w/s
单服务最多节点数：250
接入服务：2w+
接入服务器规模：1.6w+个服务器
进程数：6w+
发布日高峰：2500次
日监控数据：300G（7天一个监控周期近2T数据）
容错（任何一个服务down掉都不影响业务访问）、伸缩（服务平行扩展）、管理（统一管理平台）、故障隔离
目前MIG、SNG、IEG超50%服务进程是Taf服务（微信部分服务，如链接跳转等  也部署在taf上边，原始的taf是C++版本，后因业务需要，提供了Java版本）

2. 设计思想
Tars的设计思路是采用微服务的思想对服务进行治理，同时对整个系统的各个模块进行抽象分层，将各个层次之间相互解耦或者松耦合，如下图：
最底的协议层，设计思路是将业务网络通信的协议进行统一，以IDL(接口定义语言)的方式，开发支持多平台、可扩展、协议代码自动生成的统一协议。在开发过程中，开发人员只需要关注通讯的协议字段的内容，不需要关注其实现的细节，大大减轻了开发服务时需要考虑的协议是否能跨平台使用、是否可能需要兼容、扩展等问题。支持WUP协议（无线统一协议）打通终端到后台以及后台之间的协议（跨语言、跨平台调用）。
wup介绍：
WUP（wireless uni-protocol）无线统一协议，基于jce编码的命令字(Command)层协议封装
•提供put/get泛型接口，快速实现客户端/服务端的编/解码
•支持java、c++、object c、js、php…多种平台
•支持对象的序列化和反序列化
•支持协议动态扩展
•编码后的buffer可用于网络传输或持久化存储
•可以直接调用TAF的服务端

扩展阅读：
JCE-WUP 协议 ： https://zhiwei.li/text/2017/12/24/jce-wup%E5%8D%8F%E8%AE%AE/
TLV编码通信协议：http://www.wtango.com/tlv%E7%BC%96%E7%A0%81%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE%E8%AE%BE%E8%AE%A1/
中间的公共库、通讯框架、平台层，设计思路是让业务开发更加聚焦业务逻辑的本身。因此，从使用者的角度出发，封装了大量日常开发过程中经常使用的公共库代码和远程过程调用，让开发使用更简单方便；从框架本身的角度出发，做到高稳定性、高可用性、高性能，这样才能让业务服务运营更加放心；从分布式平台的角度出发，解决服务运营过程中，遇到的容错、负载均衡、容量管理、就近接入、灰度发布等问题，让平台更加强大。
最上面的运营层，设计思路是让运维只需要关注日常的服务部署、发布、配置、监控、调度管理等操作。

金字塔无处不在，永恒定律：用户都是沉默的，观看的







